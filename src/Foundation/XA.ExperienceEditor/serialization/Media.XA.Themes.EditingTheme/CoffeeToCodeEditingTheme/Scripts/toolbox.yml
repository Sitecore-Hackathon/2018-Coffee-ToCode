---
ID: "d08b13a9-45f4-4e70-8c72-e1ca77286d30"
Parent: "8436240f-ddcf-46b6-9eed-b77f76212ba6"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: /sitecore/media library/Base Themes/CoffeeToCodeEditingTheme/Scripts/toolbox
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/D08B13A945F44E708C72E1CA77286D30.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "f5d05944-2165-4fcb-a7fb-6b518f3c97d5"
  Value: aWYgKHR5cGVvZiAoJHhhKSAhPT0gInVuZGVmaW5lZCIpIHsNCiAgICAkeGEudG9vbGJveCA9IChmdW5jdGlvbiAoJCkgew0KICAgICAgICB2YXIgaXRlbXMsDQogICAgICAgICAgICB0cmFuc2xhdGlvbnMsDQogICAgICAgICAgICB0b29sYm94LA0KICAgICAgICAgICAgcHViID0ge30sDQogICAgICAgICAgICAkc2Nyb2xsaW5nID0gJCgnYm9keScpLA0KICAgICAgICAgICAgc2Nyb2xsZXIsDQogICAgICAgICAgICBzY3JvbGxCeSwNCiAgICAgICAgICAgIHJpYmJvbiA9ICQoIiNzY1dlYkVkaXRSaWJib24iKSwNCiAgICAgICAgICAgIHdyYXBwZXIgPSAkKCIjd3JhcHBlciIpLA0KICAgICAgICAgICAgdG91Y2hWZXJzaW9uID0gZmFsc2U7DQoNCiAgICAgICAgdmFyIGdyaXBwZXJJY29uID0gJzxkaXYgY2xhc3M9ImdyaXBwZXItaWNvbiB0b3VjaC1ncmlwcGVyIj4nDQogICAgICAgICAgICArICc8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPicNCiAgICAgICAgICAgICsgJzxnPjxyZWN0IHk9IjE0NCIgd2lkdGg9IjUxMiIgaGVpZ2h0PSIzMiIvPicNCiAgICAgICAgICAgICsgJzxyZWN0IHk9IjI0MCIgd2lkdGg9IjUxMiIgaGVpZ2h0PSIzMiIvPjxyZWN0IHk9IjMzNiIgd2lkdGg9IjUxMiIgaGVpZ2h0PSIzMiIvPjwvZz48L3N2Zz4nDQogICAgICAgICAgICArICc8L2Rpdj4nOw0KDQogICAgICAgIHZhciByZXBsYWNlSWNvbnMgPSBmdW5jdGlvbiAoaWNvbk5hbWUsIGl0ZW1zKSB7DQogICAgICAgICAgICB2YXIgaSwgbCwgY3VycmVudCwgaWNvbjsNCiAgICAgICAgICAgIGZvciAoaSA9IDAsIGwgPSBpdGVtcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsNCiAgICAgICAgICAgICAgICBjdXJyZW50ID0gJChpdGVtc1tpXSk7DQogICAgICAgICAgICAgICAgaWNvbiA9IGN1cnJlbnQuZGF0YShpY29uTmFtZSk7DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoaWNvbikgIT09ICJ1bmRlZmluZWQiKSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuY3NzKCJiYWNrZ3JvdW5kLWltYWdlIiwgInVybCgnIiArIGljb24gKyAiJykiKTsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jc3MoImJhY2tncm91bmQtcmVwZWF0IiwgIm5vLXJlcGVhdCIpOw0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNzcygiYmFja2dyb3VuZC1wb3NpdGlvbiIsICI1cHggNXB4Iik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIHZhciBzZXRUb3VjaCA9IGZ1bmN0aW9uIChpc1RvdWNoLCBuZXdUb29sYm94KSB7DQogICAgICAgICAgICBpZiAodHlwZW9mIChuZXdUb29sYm94KSA9PT0gInVuZGVmaW5lZCIgJiYgKHR5cGVvZiAodG9vbGJveCkgPT09ICJ1bmRlZmluZWQiIHx8IHRvb2xib3ggPT0gbnVsbCkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICh0eXBlb2YgKHRvb2xib3gpICE9PSAidW5kZWZpbmVkIiAmJiB0b29sYm94ICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNUb3VjaCkgew0KICAgICAgICAgICAgICAgICAgICB0b29sYm94LmZpbmQoJ2xpIGxpIHNwYW4nKS5kcmFnZ2FibGUoImRpc2FibGUiKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRvb2xib3guZmluZCgnbGkgbGkgc3BhbicpLmRyYWdnYWJsZSgiZW5hYmxlIik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG5ld1Rvb2xib3ggPSB0b29sYm94Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgaXRlbXMgPSBuZXdUb29sYm94LmZpbmQoIiNzeGEtdG9vbGJveC1yb290LXVsIGxpIHNwYW4iKTsNCiAgICAgICAgICAgIGlmIChpc1RvdWNoKSB7DQogICAgICAgICAgICAgICAgJCgiLnVpLXN0YXRlLWRpc2FibGVkIikucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIik7DQogICAgICAgICAgICAgICAgcmVwbGFjZUljb25zKCJpY29uMjQiLCBpdGVtcyk7DQogICAgICAgICAgICAgICAgbmV3VG9vbGJveCA9IG5ld1Rvb2xib3guZGV0YWNoKCk7DQogICAgICAgICAgICAgICAgd3JhcHBlci5iZWZvcmUobmV3VG9vbGJveCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXBsYWNlSWNvbnMoImljb24iLCBpdGVtcyk7DQogICAgICAgICAgICAgICAgbmV3VG9vbGJveCA9IG5ld1Rvb2xib3guZGV0YWNoKCk7DQogICAgICAgICAgICAgICAgd3JhcHBlci5iZWZvcmUobmV3VG9vbGJveCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZpeFBvc2l0aW9uVG9Cb3VuZHMobmV3VG9vbGJveCk7DQoNCiAgICAgICAgfTsNCg0KICAgICAgICBmdW5jdGlvbiBnZXRBbGxvd2VkUmVuZGVyaW5ncygpIHsNCiAgICAgICAgICAgIHZhciBhbGxvd2VkUmVuZGVyaW5ncyA9IFtdLA0KICAgICAgICAgICAgICAgIGNocm9tZXMgPSBTaXRlY29yZS5QYWdlTW9kZXMuQ2hyb21lTWFuYWdlci5jaHJvbWVzKCksDQogICAgICAgICAgICAgICAgaSwgaiwNCiAgICAgICAgICAgICAgICBjaHJvbWU7DQoNCiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjaHJvbWVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgY2hyb21lID0gY2hyb21lc1tpXTsNCiAgICAgICAgICAgICAgICBpZiAoY2hyb21lLmRhdGEgIT09IHVuZGVmaW5lZCAmJiBjaHJvbWUuZGF0YS5jdXN0b20gIT09IHVuZGVmaW5lZCAmJiBjaHJvbWUuZGF0YS5jdXN0b20uYWxsb3dlZFJlbmRlcmluZ3MgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgY2hyb21lUmVuZGVyaW5ncyA9IGNocm9tZS5kYXRhLmN1c3RvbS5hbGxvd2VkUmVuZGVyaW5nczsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGNocm9tZVJlbmRlcmluZ3MubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoY2hyb21lUmVuZGVyaW5nc1tqXSwgYWxsb3dlZFJlbmRlcmluZ3MpID09PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWRSZW5kZXJpbmdzLnB1c2goY2hyb21lUmVuZGVyaW5nc1tqXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciByZW5kZXJpbmdzID0gW107DQogICAgICAgICAgICBjaHJvbWVzLmZpbHRlcihmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBlLmRhdGEuY3VzdG9tICE9IG51bGwgJiYgZS5kYXRhLmN1c3RvbS5lZGl0YWJsZSA9PT0gInRydWUiICYmIGUuZGF0YS5jdXN0b20uYWxsb3dlZFJlbmRlcmluZ3MgIT0gbnVsbCAmJiBlLmRhdGEuY3VzdG9tLmFsbG93ZWRSZW5kZXJpbmdzLmxlbmd0aCA+IDA7DQogICAgICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmRhdGEuY3VzdG9tLmFsbG93ZWRSZW5kZXJpbmdzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gZS5kYXRhLmN1c3RvbS5hbGxvd2VkUmVuZGVyaW5nc1tpXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbmRlcmluZ3MuaW5kZXhPZihjdXJyZW50KSA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZW5kZXJpbmdzLnB1c2goY3VycmVudCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICByZXR1cm4gcmVuZGVyaW5nczsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1Yi5sb2FkQ29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICAgICAgdmFyIHEgPSAnP3NjX21vZGU9ZWRpdCc7DQogICAgICAgICAgICB2YXIgc2NTaXRlID0gZ2V0UXVlcnlTdHJpbmdQYXJhbWV0ZXJzKClbInNjX3NpdGUiXTsNCiAgICAgICAgICAgIGlmIChzY1NpdGUpIHsNCiAgICAgICAgICAgICAgICBxICs9ICcmc2Nfc2l0ZT0nICsgc2NTaXRlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgIHVybDogJy9+L3N4YS10b29sYm94L3JlbmRlcmluZ3MtZmVlZC8nICsgcSwNCiAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsDQogICAgICAgICAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgICAgICAgICBhbGxvd2VkUmVuZGVyaW5nczogSlNPTi5zdHJpbmdpZnkoZ2V0QWxsb3dlZFJlbmRlcmluZ3MoKSkNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsDQogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBkYXRhLnJlbmRlcmluZ3M7DQogICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9ucyA9IGRhdGEudHJhbnNsYXRpb25zOw0KICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9vbGJveCgpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZGF0YSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgfTsNCg0KICAgICAgICBmdW5jdGlvbiBnZXRRdWVyeVN0cmluZ1BhcmFtZXRlcnMoKSB7DQogICAgICAgICAgICB2YXIgdmFycyA9IFtdLCBoYXNoOw0KICAgICAgICAgICAgdmFyIGhhc2hlcyA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNsaWNlKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJz8nKSArIDEpLnNwbGl0KCcmJyk7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhc2hlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGhhc2ggPSBoYXNoZXNbaV0uc3BsaXQoJz0nKTsNCiAgICAgICAgICAgICAgICB2YXJzLnB1c2goaGFzaFswXSk7DQogICAgICAgICAgICAgICAgLy92YXJzW2hhc2hbMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KGhhc2hbMV0pOw0KICAgICAgICAgICAgICAgIHZhcnNbaGFzaFswXV0gPSBoYXNoWzFdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHZhcnM7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIHJlZnJlc2hUb29sYm94ID0gZnVuY3Rpb24gKCkgew0KDQogICAgICAgICAgICAkLnhhTW92ZXIucmVmcmVzaENvbmZpZ3VyYXRpb24oKTsNCg0KICAgICAgICAgICAgdmFyIG5ld1Rvb2xib3ggPSBjcmVhdGVUb29sYm94KCk7DQoNCiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoU2l0ZWNvcmUuUGFnZU1vZGVzLkNhcGFiaWxpdGllcy5kZXNpZ24sIFNpdGVjb3JlLlBhZ2VNb2Rlcy5QYWdlRWRpdG9yLmdldENhcGFiaWxpdGllcygpKSA9PSAtMSkgew0KICAgICAgICAgICAgICAgIG5ld1Rvb2xib3guaGlkZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBhcHBseVRvb2xib3hTZXR0aW5ncyhuZXdUb29sYm94KTsNCg0KICAgICAgICAgICAgaWYgKHRvb2xib3ggPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHdyYXBwZXIuYWZ0ZXIobmV3VG9vbGJveCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRvb2xib3gucmVwbGFjZVdpdGgobmV3VG9vbGJveCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRvb2xib3ggPSBuZXdUb29sYm94Ow0KICAgICAgICAgICAgZml4UG9zaXRpb25Ub0JvdW5kcyh0b29sYm94KTsNCiAgICAgICAgICAgIGluaXRUb29sYm94RXZlbnRzKCk7DQogICAgICAgICAgICB0b29sYm94LmZpbmQoJyNzeGEtdG9vbGJveC1yb290LXVsJykubUN1c3RvbVNjcm9sbGJhcih7DQogICAgICAgICAgICAgICAgdGhlbWU6ICJtaW5pbWFsLWRhcmsiDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoInN4YS10b29sYm94LWxvYWRlZCIpOw0KICAgICAgICB9Ow0KDQogICAgICAgIHZhciBjaGVja1RvdWNoID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyICRodG1sID0gJCgiaHRtbCIpOw0KDQogICAgICAgICAgICBpZiAoKCdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdykgfHwNCiAgICAgICAgICAgICAgICAoJ29ubXNnZXN0dXJlY2hhbmdlJyBpbiB3aW5kb3cpICYmDQogICAgICAgICAgICAgICAgKChuYXZpZ2F0b3IubWF4VG91Y2hQb2ludHMgPiAwKSB8fA0KICAgICAgICAgICAgICAgICAgICAobmF2aWdhdG9yLm1zTWF4VG91Y2hQb2ludHMgPiAwKSkpIHsNCiAgICAgICAgICAgICAgICAkaHRtbC5hZGRDbGFzcygiemctdG91Y2giKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgICAgICB2YXIgZ2V0VmlzaWJsZUhlaWdodCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHJldHVybiAkKHdpbmRvdykuaGVpZ2h0KCkgKyAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIGZpeFBvc2l0aW9uVG9Cb3VuZHMgPSBmdW5jdGlvbiAodG9vbGJveCkgew0KICAgICAgICAgICAgLy9maXggdG91Y2ggZXhwYW5kZXINCiAgICAgICAgICAgIHZhciBleHBhbmRlcjsNCg0KDQogICAgICAgICAgICBpZiAodG9vbGJveC5pcygiLnRvdWNoLXZlcnNpb24iKSkgew0KICAgICAgICAgICAgICAgIGV4cGFuZGVyID0gdG9vbGJveC5maW5kKCIudG91Y2gtZXhwYW5kZXIiKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZXhwYW5kZXIgPSB0b29sYm94LmZpbmQoIi5ub3JtYWwtZXhwYW5kZXIiKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGV4cGFuZGVyLmNzcygidG9wIiwgJCh3aW5kb3cpLmhlaWdodCgpIC8gMiAtIHJpYmJvbi5oZWlnaHQoKSArIGV4cGFuZGVyLmhlaWdodCgpICsgInB4Iik7DQogICAgICAgICAgICBmaXhIZWlnaHQodG9vbGJveCk7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIGZpeEhlaWdodCA9IGZ1bmN0aW9uIChqUVRvb2xib3gpIHsNCiAgICAgICAgICAgIHZhciBoZWlnaHQsIHJvb3RVbCA9IGpRVG9vbGJveC5maW5kKCIjc3hhLXRvb2xib3gtcm9vdC11bCIpOw0KICAgICAgICAgICAgaWYgKGpRVG9vbGJveC5oYXNDbGFzcygidG91Y2gtdmVyc2lvbiIpKSB7DQogICAgICAgICAgICAgICAgaGVpZ2h0ID0galFUb29sYm94LmhlaWdodCgpIC0gcmliYm9uLmhlaWdodCgpIC0gNzA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICBoZWlnaHQgPSBnZXRWaXNpYmxlSGVpZ2h0KCkgLSBqUVRvb2xib3gub2Zmc2V0KCkudG9wIC0gNTA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJvb3RVbC5jc3MoImhlaWdodCIsIGhlaWdodCk7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIGNyZWF0ZVRvb2xib3ggPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgbmV3VG9vbGJveCA9ICQoJzxkaXYgaWQ9InN4YS10b29sYm94Ij4nKSwNCiAgICAgICAgICAgICAgICB0b29sYm94U2V0dGluZ3MgPSBnZXRDb29raWUoJ3N4YS10b29sYm94Jyk7DQogICAgICAgICAgICBuZXdUb29sYm94LmFkZENsYXNzKCdtQ3VzdG9tU2Nyb2xsYmFyJyk7DQogICAgICAgICAgICB0b29sYm94U2V0dGluZ3MgPSB0b29sYm94U2V0dGluZ3MubWF0Y2goL1tefF0rL2cpOw0KDQogICAgICAgICAgICBuZXdUb29sYm94Lmh0bWwoJzxkaXYgY2xhc3M9InRvdWNoLWhlYWRlciBzeGEtdG9vbGJveC1oZWFkZXIiPicgKw0KICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJzeGEtdG9vbGJveC1sYWJlbCI+JyArIHRyYW5zbGF0aW9ucy5Ub29sYm94ICsgJzwvZGl2PicNCiAgICAgICAgICAgICAgICArICc8ZGl2IGNsYXNzPSJ0b3VjaC1idG4gYmFjay10by1kZXNrdG9wIj48L2Rpdj4nDQogICAgICAgICAgICAgICAgKyAnPC9kaXY+PGRpdiBjbGFzcz0idG91Y2gtZXhwYW5kZXIiPjwvZGl2PjxkaXYgY2xhc3M9Im5vcm1hbC1leHBhbmRlciI+PC9kaXY+Jw0KICAgICAgICAgICAgICAgICsgJzxkaXYgY2xhc3M9ImhhbmRsZSBzeGEtdG9vbGJveC1oZWFkZXIiPicgKyAnPGRpdiBjbGFzcz0ic3hhLXRvb2xib3gtbGFiZWwiPicgKyB0cmFuc2xhdGlvbnMuVG9vbGJveCArICc8L2Rpdj4nICsgJzxkaXYgY2xhc3M9ImV4cGFuZC10b29sYm94Ij48L2Rpdj48L2Rpdj4nKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdmFyIHNlYXJjaEJveCA9ICQoJzxpbnB1dCBwbGFjZWhvbGRlcj0iU2VhcmNoIGNvbnRyb2xzIC4uLiIgc3R5bGU9IndpZHRoOjEwMCU7cGFkZGluZzozcHggNnB4IiAvPicpOw0KDQogICAgICAgICAgICBzZWFyY2hCb3gua2V5dXAoZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICQoJyNzeGEtdG9vbGJveCBzcGFuLnVpLWRyYWdnYWJsZScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgJGVsID0gJChlbCk7DQogICAgICAgICAgICAgICAgICAgIGlmICgkZWwudGV4dCgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihlLnRhcmdldC52YWx1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRlbC5wYXJlbnQoJ2xpJykuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgJGVsLnBhcmVudCgnbGknKS5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBuZXdUb29sYm94LmFwcGVuZCgkKCc8ZGl2IGlkPSJzeGEtc2VhcmNoLWJveCI+PC9kaXY+JykuYXBwZW5kKHNlYXJjaEJveCkpOw0KDQogICAgICAgICAgICB2YXIgdWxGaXJzdCA9ICQoJzxkaXYgaWQ9InN4YS10b29sYm94LXJvb3QtdWwiPicpOw0KICAgICAgICAgICAgdmFyIHByZXZpb3VzUGFyZW50ID0gJyc7DQogICAgICAgICAgICB2YXIgdWxTZWNvbmQgPSAnJyA7DQogICAgICAgICAgICBpZiAoaXRlbXMgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0b29sYm94Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpXTsNCiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGl0ZW0uSUQsICR4YS54YU1vdmVyLmFsbG93ZWRSZW5kZXJpbmdzKSAhPSAtMSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNQYXJlbnQgIT0gaXRlbS5QYXJlbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUGFyZW50ID0gaXRlbS5QYXJlbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlGaXJzdCA9ICQoJzxkaXY+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICBsaUZpcnN0Lmh0bWwoJzxzcGFuIGlkPSJzeGEtdG9vbGJveC1zZWN0aW9uLScgKyBpdGVtLlBhcmVudC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16XC1dLywgJycpICsgJyI+JyArIGl0ZW0uUGFyZW50ICsgJzwvc3Bhbj4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVsRmlyc3QuYXBwZW5kKGxpRmlyc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdWxTZWNvbmQgPSAkKCc8dWw+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICBsaUZpcnN0LmFwcGVuZCh1bFNlY29uZCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGxpU2Vjb25kID0gJCgnPGxpPjxzcGFuIGRhdGEtaWNvbj0iJyArIGl0ZW0uSWNvbiArICciIGRhdGEtaWNvbjI0PSInICsgaXRlbS5JY29uMjQgKyAnIiBkYXRhLWlkPSInICsgaXRlbS5JRCArICciIHN0eWxlPSJiYWNrZ3JvdW5kOiB1cmwoJyArIGl0ZW0uSWNvbiArICcpIG5vLXJlcGVhdCA1cHggNXB4OyI+JyArIGl0ZW0uTmFtZSArICc8L3NwYW4+PC9zcGFuPjwvZGl2PicpOw0KICAgICAgICAgICAgICAgICAgICBsaVNlY29uZC5wcmVwZW5kKCQoZ3JpcHBlckljb24pKTsNCiAgICAgICAgICAgICAgICAgICAgdWxTZWNvbmQuYXBwZW5kKGxpU2Vjb25kKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICh1bEZpcnN0LmNoaWxkcmVuKCkubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICB1bEZpcnN0Lmh0bWwoJzxkaXYgY2xhc3M9InN4YS10b29sYm94LWVtcHR5Ij4nICsgdHJhbnNsYXRpb25zLk5vUmVuZGVyaW5ncyArICc8L2Rpdj4nKTsNCiAgICAgICAgICAgICAgICBuZXdUb29sYm94LmZpbmQoJy5oaWRlLXRvb2xib3gnKS5hZGRDbGFzcygnc2hvdy10b29sYm94Jyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBuZXdUb29sYm94LmFwcGVuZCh1bEZpcnN0KTsNCg0KICAgICAgICAgICAgaWYgKGNoZWNrVG91Y2goKSkgew0KICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdG9vbGJveCBtb2RlIHNldCBpbiBjb29raWUNCiAgICAgICAgICAgICAgICBpZiAoIXRvb2xib3hTZXR0aW5ncyB8fCB0b29sYm94U2V0dGluZ3NbNF0gPT0gInRydWUiKSB7DQogICAgICAgICAgICAgICAgICAgIG5ld1Rvb2xib3guYWRkQ2xhc3MoInRvdWNoLXZlcnNpb24iKTsNCiAgICAgICAgICAgICAgICAgICAgc2V0VG91Y2godHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIHRvdWNoVmVyc2lvbiA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG5ld1Rvb2xib3g7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIHNhdmVUb29sYm94U2V0dGluZ3MgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgY29sbGFwc2VkID0gdG9vbGJveC5oYXNDbGFzcygnc2hvdy10b29sYm94JykgPyAwIDogMSwNCiAgICAgICAgICAgICAgICBsZWZ0ID0gdG9vbGJveC5jc3MoJ2xlZnQnKSwNCiAgICAgICAgICAgICAgICB0b3AgPSB0b29sYm94LmNzcygndG9wJyksDQogICAgICAgICAgICAgICAgc2VjdGlvbnMgPSBudWxsOw0KDQogICAgICAgICAgICB2YXIgZXhwYW5kZWRTcGFucyA9IHRvb2xib3guZmluZCgnc3Bhbi5leHBhbmRlZCcpOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBhbmRlZFNwYW5zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgc2VjdGlvbnMgKz0gJywnICsgJChleHBhbmRlZFNwYW5zW2ldKS5hdHRyKCdpZCcpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAodG91Y2hWZXJzaW9uKSB7DQogICAgICAgICAgICAgICAgdmFyIHRvb2xib3hTZXR0aW5ncyA9IGdldENvb2tpZSgnc3hhLXRvb2xib3gnKTsNCiAgICAgICAgICAgICAgICB0b29sYm94U2V0dGluZ3MgPSB0b29sYm94U2V0dGluZ3MubWF0Y2goL1tefF0rL2cpOw0KICAgICAgICAgICAgICAgIGlmICh0b29sYm94U2V0dGluZ3MgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gdG9vbGJveFNldHRpbmdzWzFdOw0KICAgICAgICAgICAgICAgICAgICB0b3AgPSB0b29sYm94U2V0dGluZ3NbMl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAnc3hhLXRvb2xib3g9JyArIGNvbGxhcHNlZCArICd8JyArIGxlZnQgKyAnfCcgKyB0b3AgKyAnfCcgKyBzZWN0aW9ucyArICd8JyArIHRvdWNoVmVyc2lvbjsNCiAgICAgICAgfTsNCg0KICAgICAgICB2YXIgc2F2ZVRvb2xib3hTZXR0aW5nc1BhcnQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgdG9vbGJveFNldHRpbmdzID0gZ2V0Q29va2llKCdzeGEtdG9vbGJveCcpOw0KDQogICAgICAgICAgICBpZiAodG9vbGJveFNldHRpbmdzKSB7DQogICAgICAgICAgICAgICAgdG9vbGJveFNldHRpbmdzID0gdG9vbGJveFNldHRpbmdzLm1hdGNoKC9bXnxdKy9nKTsNCiAgICAgICAgICAgICAgICBpZiAodG9vbGJveFNldHRpbmdzICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gJ3N4YS10b29sYm94PScgKyB0b29sYm94U2V0dGluZ3NbMF0gKyAnfCcgKyB0b29sYm94U2V0dGluZ3NbMV0gKyAnfCcgKyB0b29sYm94U2V0dGluZ3NbMl0gKyAnfCcgKyB0b29sYm94U2V0dGluZ3NbM10gKyAnfCcgKyB0b3VjaFZlcnNpb247DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIHZhciBhcHBseVRvb2xib3hTZXR0aW5ncyA9IGZ1bmN0aW9uICh0aGVUb29sYm94KSB7DQogICAgICAgICAgICB2YXIgdG9vbGJveFNldHRpbmdzID0gZ2V0Q29va2llKCdzeGEtdG9vbGJveCcpOw0KDQogICAgICAgICAgICBpZiAodG9vbGJveFNldHRpbmdzKSB7DQogICAgICAgICAgICAgICAgdG9vbGJveFNldHRpbmdzID0gdG9vbGJveFNldHRpbmdzLm1hdGNoKC9bXnxdKy9nKTsNCg0KDQogICAgICAgICAgICAgICAgLy9jaGVjayBpZiBjb2xsYXBzZWQNCiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQodG9vbGJveFNldHRpbmdzWzBdKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aGVUb29sYm94LmFkZENsYXNzKCJzaG93LXRvb2xib3giKTsNCiAgICAgICAgICAgICAgICAgICAgdGhlVG9vbGJveC5maW5kKCcuaGlkZS10b29sYm94JykuYWRkQ2xhc3MoJ3Nob3ctdG9vbGJveCcpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vY2hlY2sgZXhwYW5kZWQgc2VjdGlvbnMNCiAgICAgICAgICAgICAgICBpZiAodG9vbGJveFNldHRpbmdzWzNdKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBleHBhbmRlZFNlY3Rpb25zID0gdG9vbGJveFNldHRpbmdzWzNdLm1hdGNoKC9bXixdKy9nKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBhbmRlZFNlY3Rpb25zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VjdGlvbiA9IHRoZVRvb2xib3guZmluZCgnIycgKyBleHBhbmRlZFNlY3Rpb25zW2ldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnBhcmVudCgpLmZpbmQoJ3VsJykuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy9jaGVjayBtb2RlICh0b3VjaC9ub3JtYWwpDQogICAgICAgICAgICAgICAgaWYgKHRvb2xib3hTZXR0aW5nc1s0XSA9PSAidHJ1ZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgdG91Y2hWZXJzaW9uID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgJCgiaHRtbCIpLmFkZENsYXNzKCJ6Zy10b3VjaCIpOw0KICAgICAgICAgICAgICAgICAgICB0aGVUb29sYm94LmFkZENsYXNzKCJ0b3VjaC12ZXJzaW9uIik7DQogICAgICAgICAgICAgICAgICAgIHNldFRvdWNoKHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICQoImh0bWwiKS5yZW1vdmVDbGFzcygiemctdG91Y2giKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBzZXRUb3VjaCh0b3VjaFZlcnNpb24sIHRoZVRvb2xib3gpOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfTsNCg0KICAgICAgICB2YXIgY2hlY2tXcmFwcGVyUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAodG9vbGJveC53aWR0aCgpICsgJCgiI3dyYXBwZXIiKS53aWR0aCgpIDwgJCh3aW5kb3cpLndpZHRoKCkpIHsNCiAgICAgICAgICAgICAgICB0b29sYm94LmFkZENsYXNzKCJ0b29sYm94LXdyYXBwZXItaGFsZiIpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0b29sYm94LnJlbW92ZUNsYXNzKCJ0b29sYm94LXdyYXBwZXItaGFsZiIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIHZhciB0b2dnbGVUb29sYm9Mb2NrID0gZmFsc2U7DQoNCiAgICAgICAgdmFyIGluaXRUb29sYm94RXZlbnRzID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIGhhbmRsZSA9IHRvb2xib3guZmluZCgiLmhhbmRsZSIpLA0KICAgICAgICAgICAgICAgIHJpYmJvblN3aXRjaGVyID0gcmliYm9uLmNvbnRlbnRzKCkuZmluZCgibmF2ID4gW2RhdGEtc2MtaWQ9J1F1aWNrUmliYm9uJ10iKSB8fCByaWJib24uY29udGVudHMoKS5maW5kKCIuc2MtcXVpY2tiYXItaXRlbS5zYy1xdWlja2Jhci1idXR0b24uc2NfUXVpY2tiYXJCdXR0b25fNTYiKTsNCg0KDQogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGZpeFBvc2l0aW9uVG9Cb3VuZHModG9vbGJveCk7DQogICAgICAgICAgICB9KTsNCg0KDQogICAgICAgICAgICByaWJib25Td2l0Y2hlci5vbigiY2xpY2siLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgZml4UG9zaXRpb25Ub0JvdW5kcyh0b29sYm94KTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICB0b29sYm94Lm9uKCJ0cmFuc2l0aW9uZW5kIHdlYmtpdFRyYW5zaXRpb25FbmQgb1RyYW5zaXRpb25FbmQgTVNUcmFuc2l0aW9uRW5kIiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIFNpdGVjb3JlLlBhZ2VNb2Rlcy5DaHJvbWVIaWdobGlnaHRNYW5hZ2VyLmhpZ2hsaWdodENocm9tZXMoKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICB2YXIgdG9nZ2xlVG9vbGJveFNob3cgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgaWYgKHRvZ2dsZVRvb2xib0xvY2spIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0b2dnbGVUb29sYm9Mb2NrID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBjaGVja1dyYXBwZXJQb3NpdGlvbigpOw0KICAgICAgICAgICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ3Nob3ctdG9vbGJveCcpOw0KICAgICAgICAgICAgICAgIHRvb2xib3gudG9nZ2xlQ2xhc3MoJ3Nob3ctdG9vbGJveCcpOw0KICAgICAgICAgICAgICAgIGZpeEhlaWdodCh0b29sYm94KTsNCiAgICAgICAgICAgICAgICBzYXZlVG9vbGJveFNldHRpbmdzKCk7DQoNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBmdW5jKCkgew0KICAgICAgICAgICAgICAgICAgICB0b2dnbGVUb29sYm9Mb2NrID0gZmFsc2U7Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmMsIDEwKTsNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHRvb2xib3guZmluZCgnLmhpZGUtdG9vbGJveCcpLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0b2dnbGVUb29sYm94U2hvdygpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHRvb2xib3guZmluZCgnLm5vcm1hbC1leHBhbmRlcicpLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0b2dnbGVUb29sYm94U2hvdygpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHRvb2xib3guZmluZCgiLnRvdWNoLWV4cGFuZGVyIikub24oImNsaWNrIHRvdWNoc3RhcnQgcG9pbnRlcmRvd24gTVNQb2ludGVyRG93biIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0b2dnbGVUb29sYm94U2hvdygpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHRvb2xib3guZmluZCgnI3N4YS10b29sYm94LXJvb3QtdWwgZGl2IHNwYW4nKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTsNCiAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJ3VsJykuc2xpZGVUb2dnbGUoImZhc3QiKTsNCiAgICAgICAgICAgICAgICBzYXZlVG9vbGJveFNldHRpbmdzKCk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgdmFyIHRvZ2dsZVRvb2xib3hUb3VjaCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBpZiAodG9nZ2xlVG9vbGJvTG9jaykgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRvZ2dsZVRvb2xib0xvY2sgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHRvb2xib3gudG9nZ2xlQ2xhc3MoInRvdWNoLXZlcnNpb24iKTsNCiAgICAgICAgICAgICAgICBzZXRUb3VjaCh0b29sYm94LmlzKCJ0b3VjaC12ZXJzaW9uIikpOw0KICAgICAgICAgICAgICAgIHRvdWNoVmVyc2lvbiA9ICF0b3VjaFZlcnNpb247DQogICAgICAgICAgICAgICAgZml4SGVpZ2h0KHRvb2xib3gpOw0KICAgICAgICAgICAgICAgIHNhdmVUb29sYm94U2V0dGluZ3NQYXJ0KCk7DQogICAgICAgICAgICAgICAgYXBwbHlUb29sYm94U2V0dGluZ3ModG9vbGJveCk7DQogICAgICAgICAgICAgICAgZml4UG9zaXRpb25Ub0JvdW5kcyh0b29sYm94KTsNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBmdW5jKCkgew0KICAgICAgICAgICAgICAgICAgICB0b2dnbGVUb29sYm9Mb2NrID0gZmFsc2U7Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmMsIDEwMCk7DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICB0b29sYm94LmZpbmQoIi5iYWNrLXRvLWRlc2t0b3AiKS5vbigiY2xpY2sgdG91Y2hzdGFydCBwb2ludGVyZG93biBNU1BvaW50ZXJEb3duIiwgZnVuY3Rpb24gKGFyZ3MpIHsNCiAgICAgICAgICAgICAgICBhcmdzLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgdG9vbGJveC5yZW1vdmVDbGFzcygidG91Y2gtdmVyc2lvbiIpOw0KICAgICAgICAgICAgICAgIHNldFRvdWNoKHRvb2xib3guaXMoInRvdWNoLXZlcnNpb24iKSk7DQogICAgICAgICAgICAgICAgdG91Y2hWZXJzaW9uID0gZmFsc2U7DQogICAgICAgICAgICAgICAgZml4SGVpZ2h0KHRvb2xib3gpOw0KICAgICAgICAgICAgICAgIHNhdmVUb29sYm94U2V0dGluZ3NQYXJ0KCk7DQogICAgICAgICAgICAgICAgYXBwbHlUb29sYm94U2V0dGluZ3ModG9vbGJveCk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgdG9vbGJveC5maW5kKCIuZXhwYW5kLXRvb2xib3giKS5vbigiY2xpY2sgdG91Y2hzdGFydCBwb2ludGVyZG93biBNU1BvaW50ZXJEb3duIiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHRvZ2dsZVRvb2xib3hUb3VjaCgpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50U3RhcnQpIHsNCiAgICAgICAgICAgICAgICB2YXIgcG9zWCwNCiAgICAgICAgICAgICAgICAgICAgcG9zWEVuZDsNCg0KICAgICAgICAgICAgICAgIGlmIChldmVudFN0YXJ0Lm9yaWdpbmFsRXZlbnQuaGFzT3duUHJvcGVydHkoInRvdWNoZXMiKSkgew0KICAgICAgICAgICAgICAgICAgICBwb3NYID0gZXZlbnRTdGFydC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcG9zWCA9IGV2ZW50U3RhcnQub3JpZ2luYWxFdmVudC5wYWdlWDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAkc2Nyb2xsaW5nLnVuYmluZCgiLmV2MyIpOw0KICAgICAgICAgICAgICAgICRzY3JvbGxpbmcub24oInRvdWNoZW5kLmV2MyBwb2ludGVydXAuZXYzIE1TUG9pbnRlclVwLmV2MyIsIGZ1bmN0aW9uIChldmVudEVuZCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAodG91Y2hWZXJzaW9uKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRFbmQub3JpZ2luYWxFdmVudC5oYXNPd25Qcm9wZXJ0eSgiY2hhbmdlZFRvdWNoZXMiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc1hFbmQgPSBldmVudEVuZC5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NYRW5kID0gZXZlbnRFbmQub3JpZ2luYWxFdmVudC5wYWdlWDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChwb3NYIDwgMjApICYmIChwb3NYIDwgcG9zWEVuZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRvb2xib3guaGFzQ2xhc3MoInNob3ctdG9vbGJveCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xib3guYWRkQ2xhc3MoJ3Nob3ctdG9vbGJveCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlVG9vbGJveFNldHRpbmdzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAkc2Nyb2xsaW5nLm9uKCJ0b3VjaHN0YXJ0IiwgaGFuZGxlcik7DQogICAgICAgICAgICBoYW5kbGUub24oInBvaW50ZXJkb3duIE1TUG9pbnRlckRvdyIsIGhhbmRsZXIpOw0KICAgICAgICAgICAgdmFyIGNhY2hlZERyYWdnYWJsZTsNCiAgICAgICAgICAgIHZhciBkcmFnZ2VyID0gew0KICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNywNCiAgICAgICAgICAgICAgICBzY3JvbGw6IHRydWUsDQogICAgICAgICAgICAgICAgaGVscGVyOiAiY2xvbmUiLA0KICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50OiAnaHRtbCcsDQogICAgICAgICAgICAgICAgYXBwZW5kVG86ICcjd3JhcHBlcicsDQogICAgICAgICAgICAgICAgY3Vyc29yQXQ6IHsgdG9wOiAtMjAsIGxlZnQ6IDIwIH0sDQogICAgICAgICAgICAgICAgcmVmcmVzaFBvc2l0aW9uczogdHJ1ZSwNCiAgICAgICAgICAgICAgICBzdGFydDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAkKCcudWktZHJhZ2dhYmxlLWRyYWdnaW5nJykuYWRkQ2xhc3MoJ3Rvb2xib3gtaXRlbScpOw0KICAgICAgICAgICAgICAgICAgICBpZiAodG91Y2hWZXJzaW9uKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCcudWktZHJhZ2dhYmxlLWRyYWdnaW5nJykuYWRkQ2xhc3MoJ3RvdWNoLWRyYWdnYWJsZScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICQueGFNb3Zlci5wcmVwYXJlRHJvcHBhYmxlUGxhY2Vob2xkZXJzKCQodGhpcyksIHRvb2xib3gpOw0KDQogICAgICAgICAgICAgICAgICAgIGNhY2hlZERyYWdnYWJsZSA9ICQoIi51aS1kcmFnZ2FibGUtZHJhZ2dpbmciKTsNCiAgICAgICAgICAgICAgICAgICAgY2FjaGVkRHJhZ2dhYmxlLnJlZnJlc2hDb3VudGVyID0gMDsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLnhhTW92ZXIuY2xlYXJEcm9wcGFibGVQbGFjZWhvbGRlcnMoKTsNCiAgICAgICAgICAgICAgICAgICAgfSwgNTApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHRvb2xib3guZmluZCgnI3N4YS10b29sYm94LXJvb3QtdWwgbGkgc3BhbicpLmRyYWdnYWJsZShkcmFnZ2VyKTsNCg0KICAgICAgICAgICAgLy9kcmFnZ2VyIGZvciB0b3VjaCBncmlwcGVyDQogICAgICAgICAgICB2YXIgdG91Y2hEcmFnZ2VyID0gJC5leHRlbmQoe30sIGRyYWdnZXIpOw0KICAgICAgICAgICAgdG91Y2hEcmFnZ2VyLmhlbHBlciA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9ICQodGhpcyk7DQogICAgICAgICAgICAgICAgdmFyIGhlbHBlciA9IHNlbGYuc2libGluZ3MoInNwYW4iKTsNCiAgICAgICAgICAgICAgICBzZWxmLmRhdGEoImlkIiwgaGVscGVyLmRhdGEoImlkIikpOw0KICAgICAgICAgICAgICAgIHJldHVybiBoZWxwZXIuY2xvbmUoKTsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB0b3VjaERyYWdnZXIuc3RhcnQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGhlbHBlciA9ICQodGhpcykuc2libGluZ3MoInNwYW4iKTsNCiAgICAgICAgICAgICAgICBkcmFnZ2VyLnN0YXJ0LmNhbGwoaGVscGVyWzBdKTsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB0b29sYm94LmZpbmQoIi50b3VjaC1ncmlwcGVyIikuZHJhZ2dhYmxlKHRvdWNoRHJhZ2dlcik7DQogICAgICAgICAgICBzZXRUb3VjaCh0b3VjaFZlcnNpb24pOw0KICAgICAgICB9Ow0KDQogICAgICAgIC8vZXh0ZW5kcyBqUXVlcnkueGFNb3Zlci5jbGVhbnVwDQogICAgICAgIHZhciBjbGVhbnVwID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgcHViLmxvYWRDb25maWd1cmF0aW9uKCk7DQogICAgICAgICAgICB9LCAxKTsNCiAgICAgICAgfTsNCg0KICAgICAgICB2YXIgZ2V0Q29va2llID0gZnVuY3Rpb24gKGNuYW1lKSB7DQogICAgICAgICAgICB2YXIgbmFtZSA9IGNuYW1lICsgIj0iOw0KICAgICAgICAgICAgdmFyIGNhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdmFyIGMgPSBjYVtpXS50cmltKCk7DQogICAgICAgICAgICAgICAgaWYgKGMuaW5kZXhPZihuYW1lKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBjLnN1YnN0cmluZyhuYW1lLmxlbmd0aCwgYy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAiIjsNCiAgICAgICAgfTsNCg0KICAgICAgICBwdWIuaW5pdCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICh0b29sYm94ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIFNpdGVjb3JlID09PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgJChkb2N1bWVudCkuZHJhZ2dhYmxlID09PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgKCQueGFNb3ZlcikgPT09ICJ1bmRlZmluZWQiKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgICAgICAgICBwdWIubG9hZENvbmZpZ3VyYXRpb24oKTsNCiAgICAgICAgICAgICAgICBTaXRlY29yZS5QYWdlTW9kZXMuQ2hyb21lTWFuYWdlci5jaHJvbWVzUmVzZXRlZC5vYnNlcnZlKCRzYy5wcm94eShmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTsNCiAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQoNCiAgICAgICAgcHViLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRvb2xib3ggPSBudWxsOw0KICAgICAgICAgICAgJCgnI3N4YS10b29sYm94JykudW5iaW5kKCkucmVtb3ZlKCk7DQogICAgICAgIH07DQoNCiAgICAgICAgcHViLmhhbmRsZVJlc3BvbnNlID0gZnVuY3Rpb24gKG1lc3NhZ2UsIHJlc3VsdCkgew0KICAgICAgICAgICAgaWYgKG1lc3NhZ2UgIT0gJ2Nocm9tZTpwbGFjZWhvbGRlcjpjb250cm9sYWRkaW5nY2FuY2VsbGVkJykgew0KICAgICAgICAgICAgICAgICQueGFNb3Zlci5jdXJyZW50Q2hyb21lLnR5cGUuYWRkQ29udHJvbFJlc3BvbnNlKHJlc3VsdC5pZCwgcmVzdWx0Lm9wZW5Qcm9wZXJ0aWVzLCByZXN1bHQuZGF0YVNvdXJjZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICQueGFNb3Zlci5jbGVhbnVwKCk7DQogICAgICAgICAgICAgICAgY2xlYW51cCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIHJldHVybiBwdWI7DQogICAgfSgkeGEpKTsNCn0=
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 22283
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20160509T085839Z
